<!doctype html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            http-equiv="Content-Security-Policy"
            content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; font-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data: https:; connect-src 'self' https://sishloxzcqapontycuyz.supabase.co wss://sishloxzcqapontycuyz.supabase.co;"
        />
        <title>공지사항 - WAVE SPACE</title>
        
        <!-- 파비콘 -->
        <link rel="icon" type="image/x-icon" href="/favicon.ico">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        
        <!-- 환경 설정 로드 (개발: config.dev.js, 운영: config.prod.js) -->
        <script src="config.dev.js"></script>
        
        <!-- XSS 보호 및 에러 핸들러 -->
        <script src="js/utils/xssProtection.js"></script>
        <script src="js/utils/errorHandler.js"></script>
        
        <!-- 공통 유틸리티 -->
        <script src="js/utils/logger.js"></script>
        <script src="js/utils/common.js"></script>
        <script src="js/utils/formatters.js"></script>
        
        <!-- CSS 파일들 -->
        <link rel="stylesheet" href="common.css?v=7" />
        <link rel="stylesheet" href="css/modules/variables.css" />
        <link rel="stylesheet" href="styles.css?v=7" />
        <link rel="stylesheet" href="css/sidebar.css?v=7" />
        <link rel="stylesheet" href="notice.css?v=7" />
        <link rel="stylesheet" href="css/checkbox-interaction.css?v=7" />
        <link rel="stylesheet" href="css/profile-style.css?v=7" />
        <link rel="stylesheet" href="mobile-fix.css?v=7" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
        
        <!-- 기본 스크립트 -->
        <script src="preload.js"></script>
                <!-- 공통 컴포넌트 로더 -->
        <script src="js/modules/header-loader.js"></script>
        <script src="js/modules/sidebar-loader.js"></script>
        <script src="js/common-loaders.js"></script>
    </head>
    <body data-page="notice" class="page-loading">
        <!-- 전체 컨테이너 -->
        <div class="app-container">
            <!-- 사이드바 (동적 로드) -->
            <div id="sidebar-container">
                <!-- SidebarLoader가 동적으로 사이드바를 여기에 로드합니다 -->
            </div>

            <!-- 메인 컨테이너 -->
            <div class="main-container">

                <!-- 메인 콘텐츠 -->
                <main class="main-content">
                    <div class="notice-container">
                        <!-- 헤더 -->
                        <div class="page-header">
                            <h1 class="page-title">공지사항</h1>
                            <p class="page-subtitle">새로운 소식과 업데이트를 확인하세요</p>
                        </div>

                        <!-- 검색 및 카테고리 필터 -->
                        <div class="notice-controls">
                            <div class="checkbox-tabs">
                                <label class="checkbox-tab active" data-category="all">
                                    <input type="radio" name="notice-filter" checked />
                                    <span class="tab-check"></span>
                                    <span>전체</span>
                                </label>
                                <label class="checkbox-tab" data-category="공지">
                                    <input type="radio" name="notice-filter" />
                                    <span class="tab-check"></span>
                                    <span>공지</span>
                                </label>
                                <label class="checkbox-tab" data-category="이벤트">
                                    <input type="radio" name="notice-filter" />
                                    <span class="tab-check"></span>
                                    <span>이벤트</span>
                                </label>
                                <label class="checkbox-tab" data-category="점검">
                                    <input type="radio" name="notice-filter" />
                                    <span class="tab-check"></span>
                                    <span>점검</span>
                                </label>
                                <label class="checkbox-tab" data-category="가이드">
                                    <input type="radio" name="notice-filter" />
                                    <span class="tab-check"></span>
                                    <span>이용가이드</span>
                                </label>
                            </div>
                            <div class="search-box">
                                <label for="searchInput" class="sr-only">제목 또는 내용으로 검색</label>
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="제목 또는 내용으로 검색" id="searchInput" />
                            </div>
                        </div>

                        <!-- 공지사항 목록 -->
                        <div class="notice-list" id="noticeList">
                            <!-- JavaScript로 동적 생성 -->
                        </div>

                        <!-- 페이지네이션 -->
                        <div class="pagination-underline" id="paginationContainer">
                            <!-- JavaScript로 동적 생성 -->
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- 플로팅 글쓰기 버튼 -->
        <button class="floating-write-btn" id="writeNoticeBtn" style="display: none">
            <i class="fas fa-pen"></i>
        </button>

        <!-- 공지사항 모달 -->
        <div class="modal-overlay" id="noticeModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-nav-buttons">
                        <button class="modal-nav-btn" id="modalPrevBtn" onclick="navigateNotice('prev')">
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="modal-nav-btn" id="modalNextBtn" onclick="navigateNotice('next')">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="modal-nav-btn modal-close-btn" id="modalClose">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-badges" id="modalBadges">
                        <!-- 동적 생성 -->
                    </div>
                    <h2 class="modal-title" id="modalTitle">
                        <!-- 동적 생성 -->
                    </h2>
                </div>
                <div class="modal-body">
                    <p class="modal-content-text" id="modalContent">
                        <!-- 동적 생성 -->
                    </p>
                </div>
                <div class="modal-meta">
                    <div class="modal-meta-item">
                        <i class="fas fa-calendar"></i>
                        <span id="modalDate"><!-- 동적 생성 --></span>
                    </div>
                </div>

                <!-- 의견 작성 섹션 -->
                <div class="modal-feedback">
                    <div class="feedback-header">
                        <h3 class="feedback-title">
                            <i class="fas fa-comment-dots"></i>
                            의견 남기기
                        </h3>
                        <p class="feedback-subtitle">본 공지사항에 대한 의견을 남겨주세요. (비공개)</p>
                    </div>
                    <div class="feedback-form">
                        <textarea
                            class="feedback-textarea"
                            id="feedbackText"
                            placeholder="의견을 입력해주세요..."
                            rows="3"
                            maxlength="500"
                        ></textarea>
                        <div class="feedback-actions">
                            <span class="char-count">
                                <span id="charCount">0</span>
                                / 500
                            </span>
                            <button class="feedback-submit-btn" id="feedbackSubmit">
                                <i class="fas fa-paper-plane"></i>
                                의견 제출
                            </button>
                        </div>
                    </div>

                    <!-- 제출된 의견 (본인 것만 표시) -->
                    <div class="feedback-submitted" id="feedbackSubmitted" style="display: none">
                        <div class="feedback-status">
                            <i class="fas fa-check-circle"></i>
                            <span>의견이 제출되었습니다.</span>
                        </div>
                        <div class="submitted-content" id="submittedContent">
                            <!-- 동적 생성 -->
                        </div>
                        <button class="feedback-edit-btn" id="feedbackEdit">
                            <i class="fas fa-edit"></i>
                            수정하기
                        </button>
                    </div>

                </div>
            </div>
        </div>

        <!-- 글쓰기 모달 -->
        <div class="modal-overlay" id="writeModal">
            <div class="modal-content write-modal">
                <div class="modal-header">
                    <h2 class="modal-title">공지사항 작성</h2>
                    <button class="modal-close" id="writeModalClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="noticeForm" class="notice-form">
                        <div class="form-group">
                            <label>
                                작성 팀
                                <span class="required">*</span>
                            </label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="team" value="운영팀" required />
                                    <span class="radio-custom"></span>
                                    <span>운영팀</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="team" value="기획팀" required />
                                    <span class="radio-custom"></span>
                                    <span>기획팀</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="team" value="영업팀" required />
                                    <span class="radio-custom"></span>
                                    <span>영업팀</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="team" value="개발팀" required />
                                    <span class="radio-custom"></span>
                                    <span>개발팀</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>
                                카테고리
                                <span class="required">*</span>
                            </label>
                            <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="category" value="공지" required />
                                    <span class="radio-custom"></span>
                                    <span>공지</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="category" value="이벤트" required />
                                    <span class="radio-custom"></span>
                                    <span>이벤트</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="category" value="점검" required />
                                    <span class="radio-custom"></span>
                                    <span>점검</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="category" value="가이드" required />
                                    <span class="radio-custom"></span>
                                    <span>가이드</span>
                                </label>
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="noticeTitle">
                                제목
                                <span class="required">*</span>
                            </label>
                            <input
                                type="text"
                                id="noticeTitle"
                                name="title"
                                placeholder="공지사항 제목을 입력하세요"
                                required
                            />
                        </div>

                        <div class="form-group">
                            <label for="noticeContent">
                                내용
                                <span class="required">*</span>
                            </label>
                            <textarea
                                id="noticeContent"
                                name="content"
                                rows="10"
                                placeholder="공지사항 내용을 입력하세요"
                                required
                            ></textarea>
                        </div>

                        <div class="form-group checkbox-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="noticePinned" name="pinned" />
                                <span class="checkbox-custom"></span>
                                <span>상단 고정</span>
                            </label>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-cancel" id="writeCancel">취소</button>
                            <button type="submit" class="btn-submit">
                                <i class="fas fa-check"></i>
                                <span>공지 등록</span>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Supabase CDN -->
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        
        <!-- Supabase 관련 스크립트 -->
        <script src="js/config/supabase.js?v=7"></script>
        <script src="js/services/noticeService.js?v=7"></script>
        <script src="js/services/authService.js?v=7" type="module"></script>
        
        <!-- 기본 스크립트 -->
        <script src="script.js?v=7"></script>
        <script src="notice.js?v=7"></script>
        
        <!-- 메인 모듈 -->
        <script type="module" src="js/main.js?v=7"></script>
    
</body>
</html>
