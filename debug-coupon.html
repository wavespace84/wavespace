<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¿ í° ë‹¹ì²¨ì ë””ë²„ê·¸</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="attendance.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body {
            padding: 40px;
            background: #f5f5f5;
        }
        .debug-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            border: 2px solid #0066ff;
        }
        .debug-section h2 {
            color: #0066ff;
            margin-top: 0;
        }
        .debug-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .debug-btn {
            padding: 10px 20px;
            background: #0066ff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        .debug-btn:hover {
            background: #0055dd;
        }
        .console-output {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .winner-display {
            padding: 15px;
            background: #f0f8ff;
            border: 2px solid #0066ff;
            border-radius: 8px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="debug-section">
        <h2>ğŸ” ì¿ í° ë‹¹ì²¨ì ë””ë²„ê·¸ í…ŒìŠ¤íŠ¸</h2>
        
        <div class="debug-buttons">
            <button class="debug-btn" onclick="testCouponSelection()">ì¿ í° ë‹¹ì²¨ì ì„ ì • í…ŒìŠ¤íŠ¸</button>
            <button class="debug-btn" onclick="checkElements()">ìš”ì†Œ ì¡´ì¬ í™•ì¸</button>
            <button class="debug-btn" onclick="clearConsole()">ì½˜ì†” í´ë¦¬ì–´</button>
            <button class="debug-btn" onclick="renderList()">ì¶œì„ ëª…ë‹¨ ë Œë”ë§</button>
        </div>
        
        <div class="console-output" id="consoleOutput"></div>
    </div>
    
    <!-- ì¿ í° ë‹¹ì²¨ì ì„¹ì…˜ (attendance.htmlê³¼ ë™ì¼) -->
    <div class="coupon-section">
        <h4><i class="fas fa-gift"></i> ì˜¤ëŠ˜ì˜ ì¿ í° ë‹¹ì²¨ì</h4>
        <p class="coupon-desc">ìƒì ì—ì„œ í¬ì¸íŠ¸ë¡œ êµ¬ë§¤ ê°€ëŠ¥í•œ ì¿ í°ì„ ë“±ìˆ˜ êµ¬ê°„ë³„ë¡œ ëœë¤í•˜ê²Œ ì¶”ì²¨í•©ë‹ˆë‹¤!</p>
        <div class="coupon-content">
            <div class="coupon-rules">
                <div class="rule-item">
                    <span class="rule-range">1~3ë“± êµ¬ê°„ (1ëª…)</span>
                    <span class="rule-prize">ìŠ¤íƒ€ë²…ìŠ¤ ì¿ í°</span>
                    <span class="winner-badge" id="winner1">ì¶”ì²¨ ëŒ€ê¸°ì¤‘</span>
                </div>
                <div class="rule-item">
                    <span class="rule-range">4~10ë“± êµ¬ê°„ (1ëª…)</span>
                    <span class="rule-prize">í¸ì˜ì  ì¿ í°</span>
                    <span class="winner-badge" id="winner2">ì¶”ì²¨ ëŒ€ê¸°ì¤‘</span>
                </div>
                <div class="rule-item">
                    <span class="rule-range">11~30ë“± êµ¬ê°„ (2ëª…)</span>
                    <span class="rule-prize">ì»¤í”¼ ì¿ í°</span>
                    <div class="winner-badges">
                        <span class="winner-badge" id="winner3-1">ì¶”ì²¨ ëŒ€ê¸°ì¤‘</span>
                        <span class="winner-badge" id="winner3-2">ì¶”ì²¨ ëŒ€ê¸°ì¤‘</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ì¶œì„ ëª…ë‹¨ -->
    <div class="today-attendance">
        <h2 class="section-title">
            <i class="fas fa-users"></i>
            ì˜¤ëŠ˜ì˜ ì¶œì„ í˜„í™© (ìƒìœ„ 30ëª…)
        </h2>
        <div class="attendance-list" id="attendanceList">
            <!-- JavaScriptë¡œ ë™ì  ìƒì„±ë©ë‹ˆë‹¤ -->
        </div>
    </div>

    <script>
        // ì½˜ì†” ì¶œë ¥ ìº¡ì²˜
        const consoleOutput = document.getElementById('consoleOutput');
        const originalLog = console.log;
        const originalError = console.error;
        
        function addToConsole(message, type = 'log') {
            const color = type === 'error' ? '#f00' : '#0f0';
            consoleOutput.innerHTML += `<div style="color: ${color}">[${type.toUpperCase()}] ${message}</div>`;
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : arg
            ).join(' ');
            addToConsole(message, 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            const message = args.map(arg => 
                typeof arg === 'object' ? JSON.stringify(arg, null, 2) : arg
            ).join(' ');
            addToConsole(message, 'error');
        };
        
        function clearConsole() {
            consoleOutput.innerHTML = '';
            console.log('ì½˜ì†” í´ë¦¬ì–´ë¨');
        }
        
        // í…ŒìŠ¤íŠ¸ ë°ì´í„°
        const attendanceData = [
            { rank: 1, name: 'ê¹€ì˜ì—…ì™•', userId: 'kimyoung', time: '07:58', message: 'ì˜¤ëŠ˜ë„ ì²« ì¶œì„!', badge: 'ì†Œí†µì™•', isCouponWinner: false },
            { rank: 2, name: 'ì´ê¸°íšì‹ ', userId: 'leeplan', time: '08:03', message: 'ì¼ì° ì¼ì–´ë‚˜ëŠ” ìƒˆ!', badge: 'ì—´ì •ë§¨', isCouponWinner: false },
            { rank: 3, name: 'ë°•íŒ€ì¥ë‹˜', userId: 'parkteam', time: '08:12', message: 'í™”ì´íŒ…!', badge: 'ë² í…Œë‘', isCouponWinner: false },
            { rank: 4, name: 'ìµœì „ë¬¸ê°€', userId: 'choiexpert', time: '08:18', message: 'ì „ë¬¸ì„±!', badge: 'ì „ë¬¸ê°€', isCouponWinner: false },
            { rank: 5, name: 'ì •ë¶„ì–‘ìŠ¤íƒ€', userId: 'jungstar', time: '08:25', message: 'ë¶„ì–‘ ë‹¬ì¸!', badge: 'ìŠ¤íƒ€', isCouponWinner: false },
            { rank: 6, name: 'í•œë§¤ë‹ˆì €', userId: 'hanmanager', time: '08:31', message: 'ê´€ë¦¬ í”„ë¡œ!', badge: 'ë§¤ë‹ˆì €', isCouponWinner: false },
            { rank: 7, name: 'êµ¬ì‹¤ì¥', userId: 'koochief', time: '08:38', message: 'ì‹¤ì¥ ì¹´ë¦¬ìŠ¤ë§ˆ!', badge: 'ë¦¬ë”', isCouponWinner: false },
            { rank: 8, name: 'ì†¡ë¶€ì¥', userId: 'songbujang', time: '08:44', message: 'ë¶€ì¥ ë¦¬ë”ì‹­!', badge: 'ë¶€ì¥', isCouponWinner: false },
            { rank: 9, name: 'ë¥˜ì°¨ì¥', userId: 'ryucha', time: '08:51', message: 'ì°¨ì¥ ì•ˆì •ê°!', badge: 'ì°¨ì¥', isCouponWinner: false },
            { rank: 10, name: 'ìœ¤ëŒ€ë¦¬', userId: 'yoondae', time: '08:57', message: 'ëŒ€ë¦¬ ì„±ì‹¤í•¨!', badge: 'ëŒ€ë¦¬', isCouponWinner: false },
            { rank: 11, name: 'ì˜¤ì£¼ì„', userId: 'ohjuim', time: '09:04', message: 'ì£¼ì„ ì±…ì„ê°!', badge: 'ì£¼ì„', isCouponWinner: false },
            { rank: 12, name: 'ë°°ì‚¬ì›', userId: 'baesa', time: '09:11', message: 'ì‹ ì… íŒ¨ê¸°!', badge: 'ì‹ ì…', isCouponWinner: false },
            { rank: 13, name: 'í™ê³¼ì¥', userId: 'honggwa', time: '09:18', message: 'ê³¼ì¥ ëŠ¥ë ¥!', badge: 'ê³¼ì¥', isCouponWinner: false },
            { rank: 14, name: 'ì„íŒ€ì¥', userId: 'limteam', time: '09:25', message: 'íŒ€ ë¦¬ë”!', badge: 'íŒ€ì¥', isCouponWinner: false },
            { rank: 15, name: 'ì¡°ì‹¤ì¥', userId: 'josil', time: '09:32', message: 'ì‹¤ë¬´ ê²½í—˜!', badge: 'ì‹¤ì¥', isCouponWinner: false },
            { rank: 16, name: 'ì‹ ë¶€ì¥', userId: 'shinbu', time: '09:39', message: 'ë¶€ì„œ ì´ê´„!', badge: 'ë¶€ì¥', isCouponWinner: false },
            { rank: 17, name: 'ë¬¸ì°¨ì¥', userId: 'mooncha', time: '09:46', message: 'ì°¨ê·¼ì°¨ê·¼!', badge: 'ì°¨ì¥', isCouponWinner: false },
            { rank: 18, name: 'ìœ ëŒ€ë¦¬', userId: 'yoodae', time: '09:53', message: 'ì Šì€ íŒ¨ê¸°!', badge: 'ëŒ€ë¦¬', isCouponWinner: false },
            { rank: 19, name: 'ê°•ì£¼ì„', userId: 'kangjuim', time: '10:01', message: 'ê°•í•œ ì˜ì§€!', badge: 'ì£¼ì„', isCouponWinner: false },
            { rank: 20, name: 'ì¥ì‚¬ì›', userId: 'jangsa', time: '10:08', message: 'ì„±ì¥í•˜ëŠ” ì‚¬ì›!', badge: 'ì‚¬ì›', isCouponWinner: false },
            { rank: 21, name: 'ê¶Œê³¼ì¥', userId: 'kwongwa', time: '10:15', message: 'ê¶Œìœ„ ìˆëŠ”!', badge: 'ê³¼ì¥', isCouponWinner: false },
            { rank: 22, name: 'ë…¸íŒ€ì¥', userId: 'noteam', time: '10:22', message: 'ë…¸ë ¨í•œ íŒ€!', badge: 'íŒ€ì¥', isCouponWinner: false },
            { rank: 23, name: 'ì„œì‹¤ì¥', userId: 'seosil', time: '10:29', message: 'ì—¬ìœ ë¡œìš´!', badge: 'ì‹¤ì¥', isCouponWinner: false },
            { rank: 24, name: 'ê³ ë¶€ì¥', userId: 'gobu', time: '10:36', message: 'ê³ í’ˆê²©!', badge: 'ë¶€ì¥', isCouponWinner: false },
            { rank: 25, name: 'ë°•ìŠ¹í•™', userId: 'parksh', time: '10:43', message: 'ì—´ì‹¬íˆ!', badge: 'ì´ˆë³´ì', isCouponWinner: false },
            { rank: 26, name: 'ì¡°ëŒ€ë¦¬', userId: 'jodae', time: '10:50', message: 'ì¡°ìš©íˆ!', badge: 'ëŒ€ë¦¬', isCouponWinner: false },
            { rank: 27, name: 'ë¯¼ì£¼ì„', userId: 'minjuim', time: '10:57', message: 'ë¯¼ì²©í•œ!', badge: 'ì£¼ì„', isCouponWinner: false },
            { rank: 28, name: 'ì•ˆì‚¬ì›', userId: 'ansa', time: '11:04', message: 'ì•ˆì •ì !', badge: 'ì‚¬ì›', isCouponWinner: false },
            { rank: 29, name: 'ì‹¬ê³¼ì¥', userId: 'simgwa', time: '11:11', message: 'ì‹¬ë„ ìˆëŠ”!', badge: 'ê³¼ì¥', isCouponWinner: false },
            { rank: 30, name: 'ë‚˜íŒ€ì¥', userId: 'nateam', time: '11:18', message: 'ë‚˜ë§Œì˜!', badge: 'íŒ€ì¥', isCouponWinner: false }
        ];
        
        // ì¿ í° ë‹¹ì²¨ì ì„ ì • í…ŒìŠ¤íŠ¸
        function testCouponSelection() {
            console.log('===== ì¿ í° ë‹¹ì²¨ì ì„ ì • í…ŒìŠ¤íŠ¸ ì‹œì‘ =====');
            
            // ëª¨ë“  isCouponWinnerë¥¼ falseë¡œ ì´ˆê¸°í™”
            attendanceData.forEach(user => {
                user.isCouponWinner = false;
            });
            console.log('1. ëª¨ë“  ì‚¬ìš©ì isCouponWinner ì´ˆê¸°í™” ì™„ë£Œ');
            
            // 1~3ë“± ì¤‘ 1ëª…
            const group1 = attendanceData.filter(u => u.rank >= 1 && u.rank <= 3);
            console.log(`2. 1~3ë“± ê·¸ë£¹: ${group1.length}ëª…`, group1.map(u => u.name));
            
            if (group1.length > 0) {
                const winner1 = group1[Math.floor(Math.random() * group1.length)];
                winner1.isCouponWinner = true;
                
                const winner1Element = document.getElementById('winner1');
                if (winner1Element) {
                    winner1Element.textContent = `ğŸ‰ ${winner1.name}`;
                    winner1Element.className = 'winner-badge winner-selected';
                    console.log(`âœ… 1~3ë“± ë‹¹ì²¨ì: ${winner1.name}`);
                } else {
                    console.error('âŒ winner1 ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                }
            }
            
            // 4~10ë“± ì¤‘ 1ëª…
            const group2 = attendanceData.filter(u => u.rank >= 4 && u.rank <= 10);
            console.log(`3. 4~10ë“± ê·¸ë£¹: ${group2.length}ëª…`, group2.map(u => u.name));
            
            if (group2.length > 0) {
                const winner2 = group2[Math.floor(Math.random() * group2.length)];
                winner2.isCouponWinner = true;
                
                const winner2Element = document.getElementById('winner2');
                if (winner2Element) {
                    winner2Element.textContent = `ğŸ‰ ${winner2.name}`;
                    winner2Element.className = 'winner-badge winner-selected';
                    console.log(`âœ… 4~10ë“± ë‹¹ì²¨ì: ${winner2.name}`);
                } else {
                    console.error('âŒ winner2 ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                }
            }
            
            // 11~30ë“± ì¤‘ 2ëª…
            const group3 = attendanceData.filter(u => u.rank >= 11 && u.rank <= 30);
            console.log(`4. 11~30ë“± ê·¸ë£¹: ${group3.length}ëª…`);
            
            if (group3.length > 0) {
                const winner3_1 = group3[Math.floor(Math.random() * group3.length)];
                winner3_1.isCouponWinner = true;
                
                const winner3_1Element = document.getElementById('winner3-1');
                if (winner3_1Element) {
                    winner3_1Element.textContent = `ğŸ‰ ${winner3_1.name}`;
                    winner3_1Element.className = 'winner-badge winner-selected';
                    console.log(`âœ… 11~30ë“± ì²«ë²ˆì§¸ ë‹¹ì²¨ì: ${winner3_1.name}`);
                } else {
                    console.error('âŒ winner3-1 ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                }
                
                const remainingGroup3 = group3.filter(u => u.name !== winner3_1.name);
                if (remainingGroup3.length > 0) {
                    const winner3_2 = remainingGroup3[Math.floor(Math.random() * remainingGroup3.length)];
                    winner3_2.isCouponWinner = true;
                    
                    const winner3_2Element = document.getElementById('winner3-2');
                    if (winner3_2Element) {
                        winner3_2Element.textContent = `ğŸ‰ ${winner3_2.name}`;
                        winner3_2Element.className = 'winner-badge winner-selected';
                        console.log(`âœ… 11~30ë“± ë‘ë²ˆì§¸ ë‹¹ì²¨ì: ${winner3_2.name}`);
                    } else {
                        console.error('âŒ winner3-2 ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                    }
                }
            }
            
            // ìµœì¢… ë‹¹ì²¨ì í™•ì¸
            const winners = attendanceData.filter(u => u.isCouponWinner === true);
            console.log(`===== ìµœì¢… ë‹¹ì²¨ì: ${winners.length}ëª… =====`);
            winners.forEach(w => {
                console.log(`ğŸ ${w.rank}ë“± ${w.name}`);
            });
            
            // ì¶œì„ ëª…ë‹¨ ë Œë”ë§
            renderList();
        }
        
        // ìš”ì†Œ ì¡´ì¬ í™•ì¸
        function checkElements() {
            console.log('===== ìš”ì†Œ ì¡´ì¬ í™•ì¸ =====');
            const elements = ['winner1', 'winner2', 'winner3-1', 'winner3-2', 'attendanceList'];
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    console.log(`âœ… ${id}: ì¡´ì¬í•¨`, element);
                } else {
                    console.error(`âŒ ${id}: ì—†ìŒ`);
                }
            });
        }
        
        // ì¶œì„ ëª…ë‹¨ ë Œë”ë§
        function renderList() {
            console.log('===== ì¶œì„ ëª…ë‹¨ ë Œë”ë§ =====');
            const listElement = document.getElementById('attendanceList');
            
            if (!listElement) {
                console.error('âŒ attendanceList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
                return;
            }
            
            let html = '';
            attendanceData.forEach(user => {
                const points = user.rank <= 3 ? 1000 : user.rank <= 10 ? 800 : user.rank <= 30 ? 500 : 300;
                
                html += `
                    <div class="attendance-item ${user.isCouponWinner ? 'coupon-winner-row' : ''}">
                        <div class="rank-wrapper">
                            ${user.rank <= 3 ? `<i class="fas fa-medal medal-${user.rank === 1 ? 'gold' : user.rank === 2 ? 'silver' : 'bronze'}"></i>` : ''}
                            <span class="rank-number">${user.rank}ë“±</span>
                        </div>
                        <div class="check-time">${user.time}</div>
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="user-name-wrapper">
                            <span class="user-id">${user.userId}</span>
                            <span class="user-badge">${user.badge}</span>
                        </div>
                        <div class="user-message">${user.message}</div>
                        ${user.isCouponWinner ? '<div class="coupon-winner"><i class="fas fa-ticket-alt"></i> ì¿ í° ë‹¹ì²¨!</div>' : ''}
                        <div class="points-badge">+${points}P</div>
                    </div>
                `;
            });
            
            listElement.innerHTML = html;
            console.log(`âœ… ${attendanceData.length}ëª… ë Œë”ë§ ì™„ë£Œ`);
            
            // ë‹¹ì²¨ìê°€ í‘œì‹œë˜ì—ˆëŠ”ì§€ í™•ì¸
            const winnerCount = attendanceData.filter(u => u.isCouponWinner).length;
            console.log(`ğŸ ì¶œì„ ëª…ë‹¨ì— í‘œì‹œëœ ë‹¹ì²¨ì: ${winnerCount}ëª…`);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
        window.onload = function() {
            console.log('ğŸš€ ë””ë²„ê·¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            checkElements();
        };
    </script>
</body>
</html>