<!doctype html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>업데이트 - WAVE SPACE</title>
        
        <!-- 환경 설정 로드 (개발: config.dev.js, 운영: config.prod.js) -->
        <script src="config.dev.js"></script>
        
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="preload.js"></script>
                <!-- 공통 컴포넌트 로더 -->
        <script src="js/modules/header-loader.js"></script>
        <script src="js/modules/sidebar-loader.js"></script>
        <script src="js/common-loaders.js"></script>
        <link rel="stylesheet" href="common.css" />
        <link rel="stylesheet" href="css/modules/variables.css" />
        <link rel="stylesheet" href="styles.css?v=7" />
        <link rel="stylesheet" href="css/sidebar.css?v=7" />
        <link rel="stylesheet" href="updates.css" />
        <link rel="stylesheet" href="css/checkbox-interaction.css" />
        <link rel="stylesheet" href="mobile-fix.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    </head>
    <body data-page="updates">
        <!-- 전체 컨테이너 -->
        <div class="app-container">
            <!-- 사이드바 (동적 로드) -->
            <div id="sidebar-container">
                <!-- SidebarLoader가 동적으로 사이드바를 여기에 로드합니다 -->
            </div>

            <!-- 메인 컨테이너 -->
            <div class="main-container">

                <!-- 메인 콘텐츠 -->
                <main class="main-content">
                    <div class="updates-container">
                        <!-- 헤더 -->
                        <div class="page-header">
                            <h1 class="page-title">업데이트</h1>
                            <p class="updates-subtitle">새로운 기능과 개선사항을 확인하세요</p>
                        </div>

                        <!-- 검색 및 카테고리 필터 -->
                        <div class="updates-controls">
                            <div class="checkbox-tabs">
                                <label class="checkbox-tab active" data-category="all">
                                    <input type="radio" name="update-filter" checked />
                                    <span class="tab-check"></span>
                                    <span>전체</span>
                                </label>
                                <label class="checkbox-tab" data-category="기능추가">
                                    <input type="radio" name="update-filter" />
                                    <span class="tab-check"></span>
                                    <span>기능추가</span>
                                </label>
                                <label class="checkbox-tab" data-category="개선">
                                    <input type="radio" name="update-filter" />
                                    <span class="tab-check"></span>
                                    <span>개선</span>
                                </label>
                                <label class="checkbox-tab" data-category="버그수정">
                                    <input type="radio" name="update-filter" />
                                    <span class="tab-check"></span>
                                    <span>버그수정</span>
                                </label>
                                <label class="checkbox-tab" data-category="보안">
                                    <input type="radio" name="update-filter" />
                                    <span class="tab-check"></span>
                                    <span>보안</span>
                                </label>
                            </div>
                            <div class="search-box">
                                <label for="searchInput" class="sr-only">업데이트 내용 검색</label>
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="업데이트 내용 검색" id="searchInput" />
                            </div>
                        </div>

                        <!-- 업데이트 목록 -->
                        <div class="updates-list" id="updatesList">
                            <!-- JavaScript로 동적 생성 -->
                        </div>

                        <!-- 페이지네이션 -->
                        <div class="pagination-underline" id="paginationContainer">
                            <!-- JavaScript로 동적 생성 -->
                        </div>
                    </div>
                </main>
            </div>
        </div>

        <!-- 플로팅 글쓰기 버튼 (관리자용) -->
        <button class="floating-write-btn" id="writeUpdateBtn" style="display: none">
            <i class="fas fa-pen"></i>
        </button>

        <!-- 업데이트 상세 모달 -->
        <div class="modal-overlay" id="updateModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-nav-buttons">
                        <button class="modal-nav-btn" onclick="navigateUpdate('prev')" disabled>
                            <i class="fas fa-chevron-left"></i>
                        </button>
                        <button class="modal-nav-btn" onclick="navigateUpdate('next')">
                            <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="modal-nav-btn modal-close-btn" id="modalClose">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-badges" id="modalBadges">
                        <span class="update-category" id="modalCategory">
                            <i class="fas fa-sparkles"></i>
                            <span>카테고리</span>
                        </span>
                    </div>
                    <h2 class="modal-title" id="modalTitle">업데이트 제목</h2>
                </div>
                <div class="modal-body">
                    <div class="modal-description" id="modalDescription">업데이트 설명이 여기에 표시됩니다.</div>

                    <div class="modal-changes">
                        <h3 class="changes-title">
                            <i class="fas fa-list-check"></i>
                            변경사항
                        </h3>
                        <ul class="modal-changes-list" id="modalChangesList">
                            <!-- 변경사항이 동적으로 추가됩니다 -->
                        </ul>
                    </div>
                </div>
                <div class="modal-meta">
                    <div class="modal-meta-item">
                        <i class="fas fa-calendar"></i>
                        <span id="modalDateText">2024-01-18</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 업데이트 글쓰기 모달 -->
        <div class="modal-overlay" id="writeUpdateModal">
            <div class="modal-content write-modal">
                <div class="modal-header">
                    <h2 class="modal-title">업데이트 작성</h2>
                    <button class="modal-close" id="writeModalClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <div class="modal-body">
                    <form class="update-form" id="updateForm">
                        <div class="form-group">
                            <label for="updateTitle">
                                제목
                                <span class="required">*</span>
                            </label>
                            <input
                                type="text"
                                id="updateTitle"
                                name="title"
                                required
                                placeholder="업데이트 제목을 입력하세요"
                            />
                        </div>

                        <div class="form-group">
                            <fieldset>
                                <legend>
                                    카테고리
                                    <span class="required">*</span>
                                </legend>
                                <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="category" value="기능추가" required />
                                    <span class="radio-custom"></span>
                                    <span>기능추가</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="category" value="개선" required />
                                    <span class="radio-custom"></span>
                                    <span>개선</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="category" value="버그수정" required />
                                    <span class="radio-custom"></span>
                                    <span>버그수정</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="category" value="보안" required />
                                    <span class="radio-custom"></span>
                                    <span>보안</span>
                                </label>
                            </div>
                            </fieldset>
                        </div>

                        <div class="form-group">
                            <fieldset>
                                <legend>
                                    업데이트 타입
                                    <span class="required">*</span>
                                </legend>
                                <div class="radio-group">
                                <label class="radio-label">
                                    <input type="radio" name="type" value="major" required />
                                    <span class="radio-custom"></span>
                                    <span>Major (주요 업데이트)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="type" value="minor" required />
                                    <span class="radio-custom"></span>
                                    <span>Minor (기능 개선)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="type" value="patch" required />
                                    <span class="radio-custom"></span>
                                    <span>Patch (버그 수정)</span>
                                </label>
                                <label class="radio-label">
                                    <input type="radio" name="type" value="hotfix" required />
                                    <span class="radio-custom"></span>
                                    <span>Hotfix (긴급 패치)</span>
                                </label>
                            </div>
                            </fieldset>
                        </div>

                        <div class="form-group">
                            <label for="updateDescription">
                                설명
                                <span class="required">*</span>
                            </label>
                            <textarea
                                id="updateDescription"
                                name="description"
                                rows="4"
                                required
                                placeholder="업데이트에 대한 설명을 입력하세요"
                            ></textarea>
                        </div>

                        <div class="form-group">
                            <div id="updateChangesLabel">
                                변경사항
                                <span class="required">*</span>
                            </div>
                            <div class="changes-input-container">
                                <div id="changesInputList">
                                    <div class="change-input-item">
                                        <label for="change-input-0" class="sr-only">변경사항 1</label>
                                        <input
                                            type="text"
                                            class="change-input"
                                            name="changes[]"
                                            id="change-input-0"
                                            placeholder="변경사항을 입력하세요"
                                            required
                                        />
                                        <button type="button" class="remove-change-btn" style="display: none">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                                <button type="button" class="add-change-btn" id="addChangeBtn">
                                    <i class="fas fa-plus"></i>
                                    변경사항 추가
                                </button>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn-cancel" id="cancelWriteBtn">
                                <i class="fas fa-times"></i>
                                취소
                            </button>
                            <button type="submit" class="btn-submit">
                                <i class="fas fa-check"></i>
                                업데이트 등록
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- JavaScript -->
        <script src="js/config/supabase.js"></script>
        <script src="js/services/authService.js"></script>
        <script src="js/pages/updatesSupabase.js"></script>
        <script src="script.js"></script>
        <script src="updates.js"></script>
        
        <!-- ES6 모듈 메인 스크립트 -->
        <script type="module" src="js/main.js"></script>
    </body>
</html>
