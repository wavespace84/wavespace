<!doctype html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta
            http-equiv="Content-Security-Policy"
            content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; font-src 'self' https://cdnjs.cloudflare.com https://cdn.jsdelivr.net; img-src 'self' data: https:; connect-src 'self' https://sishloxzcqapontycuyz.supabase.co wss://sishloxzcqapontycuyz.supabase.co;"
        />
        <title>전체랭킹 - WAVE SPACE</title>
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script src="preload.js"></script>
        <link rel="stylesheet" href="common.css" />
        <link rel="stylesheet" href="styles.css?v=7" />
        <link rel="stylesheet" href="points-ranking.css" />
        <link rel="stylesheet" href="mobile-fix.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    </head>
    <body data-page="points-ranking">
        <!-- 전체 컨테이너 -->
        <div class="app-container">
            <!-- 사이드바 (동적 로드) -->

            <div id="sidebar-container">

                <!-- SidebarLoader가 동적으로 사이드바를 여기에 로드합니다 -->

            </div>

            <!-- 메인 콘텐츠 영역 -->
            <div class="main-container">

                <!-- 메인 콘텐츠 -->
                <main class="main-content">
                    <div class="ranking-container">
                        <!-- 헤더 -->
                        <div class="page-header">
                            <h1 class="page-title">전체 랭킹</h1>
                            <p class="ranking-subtitle">상위 100명의 포인트 랭킹을 확인해보세요</p>
                        </div>

                        <!-- TOP 3 포인트랭킹 섹션 -->
                        <div class="super-rich-section">
                            <div class="super-rich-header">
                                <h2 class="section-title">
                                    <i class="fas fa-crown"></i>
                                    포인트랭킹 TOP 3
                                </h2>
                            </div>
                            
                            
                            <div class="top-three-podium">
                                <!-- 2등 -->
                                <div class="podium-item second" id="rank-2">
                                    <div class="rank-number">2</div>
                                    <div class="user-avatar-container">
                                        <div class="user-avatar">
                                            <span>-</span>
                                        </div>
                                        <div class="membership-type">순위 없음</div>
                                    </div>
                                    <div class="user-info">
                                        <div class="nickname">순위 없음</div>
                                        <div class="representative-badge-text">
                                            <span class="badge-name">ㅣ-ㅣ</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- 1등 (가장 크게) -->
                                <div class="podium-item first" id="rank-1">
                                    <div class="rank-number">1</div>
                                    <div class="user-avatar-container">
                                        <div class="user-avatar">
                                            <span>-</span>
                                        </div>
                                        <div class="membership-type">순위 없음</div>
                                    </div>
                                    <div class="user-info">
                                        <div class="nickname">순위 없음</div>
                                        <div class="representative-badge-text">
                                            <span class="badge-name">ㅣ-ㅣ</span>
                                        </div>
                                    </div>
                                    <div class="crown-decoration">
                                        <i class="fas fa-crown"></i>
                                    </div>
                                </div>

                                <!-- 3등 -->
                                <div class="podium-item third" id="rank-3">
                                    <div class="rank-number">3</div>
                                    <div class="user-avatar-container">
                                        <div class="user-avatar">
                                            <span>-</span>
                                        </div>
                                        <div class="membership-type">순위 없음</div>
                                    </div>
                                    <div class="user-info">
                                        <div class="nickname">순위 없음</div>
                                        <div class="representative-badge-text">
                                            <span class="badge-name">ㅣ-ㅣ</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 슈퍼리치 뱃지 효과 안내 -->
                            <div class="super-rich-badge-guide">
                                <div class="guide-header">
                                    <div class="guide-title-section">
                                        <h3 class="guide-title">TOP 3 특별 혜택</h3>
                                        <p class="guide-subtitle">슈퍼리치 뱃지 활성화 시 특별한 기능이 적용됩니다</p>
                                    </div>
                                </div>
                                
                                <div class="guide-content">
                                    <div class="benefit-grid">
                                        <!-- 슈퍼리치 뱃지 획득 -->
                                        <div class="benefit-card">
                                            <div class="benefit-icon">
                                                <i class="fas fa-medal"></i>
                                            </div>
                                            <div class="benefit-info">
                                                <h4>슈퍼리치 뱃지 획득</h4>
                                                <p>TOP 3 진입 시 슈퍼리치 뱃지를 대표뱃지로 설정할 수 있습니다</p>
                                            </div>
                                        </div>
                                        
                                        <!-- 즉시 효과 적용 -->
                                        <div class="benefit-card">
                                            <div class="benefit-icon">
                                                <i class="fas fa-zap"></i>
                                            </div>
                                            <div class="benefit-info">
                                                <h4>즉시 효과 적용</h4>
                                                <p>뱃지 획득 시 즉시 뱃지 효과가 적용됩니다</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 추가 안내 -->
                                    <div class="badge-notice">
                                        <i class="fas fa-info-circle"></i>
                                        <span>슈퍼리치 뱃지는 실시간 포인트 순위에 따라 자동으로 변경됩니다. (포인트 획득 추가 3%, 포인트 차감 감소 3% / 단, 미니게임에는 적용되지 않습니다)</span>
                                    </div>
                                </div>
                            </div>
                            
                        </div>

                        <!-- 현재 보유 포인트 및 통계 정보 -->
                        <div class="ranking-stats-top">
                            <div class="stat-item-card">
                                <div class="stat-icon">
                                    <i class="fas fa-trophy"></i>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">내 순위</p>
                                    <p class="stat-value" id="myRankDisplay">로그인 필요</p>
                                </div>
                            </div>
                            <div class="stat-item-card">
                                <div class="stat-icon">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">내 포인트</p>
                                    <p class="stat-value" id="myPointsDisplay">0P</p>
                                </div>
                            </div>
                            <div class="stat-item-card">
                                <div class="stat-icon">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">순위 변동</p>
                                    <p class="stat-value" id="myChangeDisplay">
                                        <span class="change-icon">-</span>
                                        <span class="change-value">0위</span>
                                        <span class="change-desc">(전일대비)</span>
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- 4위~100위 랭킹 리스트 -->
                        <div class="ranking-list-section">
                            <div class="ranking-list-header">
                                <h3 class="section-title">전체 랭킹 TOP 100</h3>
                                <div class="list-controls">
                                    <button class="control-btn" id="scrollToMyRank">
                                        <i class="fas fa-crosshairs"></i>
                                        내 순위 자세히 보기
                                    </button>
                                </div>
                            </div>
                            
                            <div class="ranking-table">
                                <div class="table-header">
                                    <div class="col-rank">순위</div>
                                    <div class="col-user">유저</div>
                                    <div class="col-badge">뱃지</div>
                                    <div class="col-points">포인트</div>
                                    <div class="col-change">전일대비</div>
                                </div>
                                
                                <div class="table-body" id="rankingTableBody">
                                    <!-- JavaScript로 동적 생성 -->
                                </div>
                                
                                <!-- 100위권 밖 구분선 -->
                                <div class="out-of-100" id="outOf100Divider" style="display: none;">
                                    <span>100위권 밖</span>
                                </div>
                                
                                <!-- 100위권 밖 내 순위 -->
                                <div class="my-rank-outside" id="myRankOutside" style="display: none;">
                                    <!-- JavaScript로 동적 생성 -->
                                </div>
                            </div>
                        </div>

                    </div>
                </main>
            </div>
        </div>

        <!-- 내 순위 카드 (플로팅) -->
        <div class="my-rank-card" id="myRankCard">
            <div class="my-rank-content">
                <div class="rank-status" id="rankStatus">
                    <i class="fas fa-trophy"></i>
                    <span>TOP 100 진입!</span>
                </div>
                <div class="rank-details">
                    <div class="rank-item">
                        <span class="label">내 순위:</span>
                        <span class="value" id="myRankValue">44위</span>
                    </div>
                    <div class="rank-item">
                        <span class="label">내 포인트:</span>
                        <span class="value" id="myPointsValue">82,500P</span>
                    </div>
                    <div class="rank-item">
                        <span class="label">다음 순위까지:</span>
                        <span class="value" id="nextRankPoints">2,500P</span>
                    </div>
                    <div class="rank-item">
                        <span class="label">이번 주:</span>
                        <span class="value change-up" id="weeklyChange">▲2 (상승!)</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 내 순위로 스크롤 버튼 -->
        <button class="scroll-to-my-rank" id="scrollToMyRankBtn" title="내 순위 자세히 보기">
            <i class="fas fa-crosshairs"></i>
        </button>

        <!-- 색종이가루 효과 컨테이너 -->
        <div class="confetti-container">
            <div class="confetti confetti-1"></div>
            <div class="confetti confetti-2"></div>
            <div class="confetti confetti-3"></div>
            <div class="confetti confetti-4"></div>
            <div class="confetti confetti-5"></div>
            <div class="confetti confetti-6"></div>
            <div class="confetti confetti-7"></div>
            <div class="confetti confetti-8"></div>
            <div class="confetti confetti-9"></div>
            <div class="confetti confetti-10"></div>
            <div class="confetti confetti-11"></div>
            <div class="confetti confetti-12"></div>
            <div class="confetti confetti-13"></div>
            <div class="confetti confetti-14"></div>
            <div class="confetti confetti-15"></div>
            <div class="confetti confetti-16"></div>
            <div class="confetti confetti-17"></div>
            <div class="confetti confetti-18"></div>
            <div class="confetti confetti-19"></div>
            <div class="confetti confetti-20"></div>
            <div class="confetti confetti-21"></div>
            <div class="confetti confetti-22"></div>
            <div class="confetti confetti-23"></div>
            <div class="confetti confetti-24"></div>
            <div class="confetti confetti-25"></div>
            <div class="confetti confetti-26"></div>
            <div class="confetti confetti-27"></div>
            <div class="confetti confetti-28"></div>
            <div class="confetti confetti-29"></div>
            <div class="confetti confetti-30"></div>
            <div class="confetti confetti-31"></div>
            <div class="confetti confetti-32"></div>
            <div class="confetti confetti-33"></div>
            <div class="confetti confetti-34"></div>
            <div class="confetti confetti-35"></div>
            <div class="confetti confetti-36"></div>
            <div class="confetti confetti-37"></div>
            <div class="confetti confetti-38"></div>
            <div class="confetti confetti-39"></div>
            <div class="confetti confetti-40"></div>
            <div class="confetti confetti-41"></div>
            <div class="confetti confetti-42"></div>
            <div class="confetti confetti-43"></div>
            <div class="confetti confetti-44"></div>
            <div class="confetti confetti-45"></div>
            <div class="confetti confetti-46"></div>
            <div class="confetti confetti-47"></div>
            <div class="confetti confetti-48"></div>
            <div class="confetti confetti-49"></div>
            <div class="confetti confetti-50"></div>
            <div class="confetti confetti-51"></div>
            <div class="confetti confetti-52"></div>
            <div class="confetti confetti-53"></div>
            <div class="confetti confetti-54"></div>
            <div class="confetti confetti-55"></div>
            <div class="confetti confetti-56"></div>
            <div class="confetti confetti-57"></div>
            <div class="confetti confetti-58"></div>
            <div class="confetti confetti-59"></div>
            <div class="confetti confetti-60"></div>
        </div>

        <!-- 추가 색종이가루 효과 컨테이너 - 더 일찍 사라짐 -->
        <div class="confetti-container-short">
            <div class="confetti confetti-61"></div>
            <div class="confetti confetti-62"></div>
            <div class="confetti confetti-63"></div>
            <div class="confetti confetti-64"></div>
            <div class="confetti confetti-65"></div>
            <div class="confetti confetti-66"></div>
            <div class="confetti confetti-67"></div>
            <div class="confetti confetti-68"></div>
            <div class="confetti confetti-69"></div>
            <div class="confetti confetti-70"></div>
            <div class="confetti confetti-71"></div>
            <div class="confetti confetti-72"></div>
            <div class="confetti confetti-73"></div>
            <div class="confetti confetti-74"></div>
            <div class="confetti confetti-75"></div>
            <div class="confetti confetti-76"></div>
            <div class="confetti confetti-77"></div>
            <div class="confetti confetti-78"></div>
            <div class="confetti confetti-79"></div>
            <div class="confetti confetti-80"></div>
            <div class="confetti confetti-81"></div>
            <div class="confetti confetti-82"></div>
            <div class="confetti confetti-83"></div>
            <div class="confetti confetti-84"></div>
            <div class="confetti confetti-85"></div>
            <div class="confetti confetti-86"></div>
            <div class="confetti confetti-87"></div>
            <div class="confetti confetti-88"></div>
            <div class="confetti confetti-89"></div>
            <div class="confetti confetti-90"></div>
        </div>

        <script src="script.js?v=7"></script>
        
        <!-- Supabase 통합 -->
        <script type="module" src="js/config/supabase.js"></script>
        <script type="module" src="js/services/authService.js"></script>
        <script type="module" src="js/pages/pointsRankingSupabase.js"></script>
        <!-- ES6 모듈 메인 스크립트 -->
    <script type="module" src="js/main.js"></script>
    
</body>
</html>
