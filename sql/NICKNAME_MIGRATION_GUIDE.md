# 닉네임 기능 추가 마이그레이션 가이드

## 개요
사용자가 설정한 닉네임이 제대로 표시되지 않는 문제를 해결하기 위해 다음과 같은 수정사항을 적용했습니다.

## 적용된 변경사항

### 1. 데이터베이스 스키마 변경
- `users` 테이블에 `nickname` 컬럼 추가
- 닉네임 중복 체크를 위한 인덱스 및 함수 추가
- `schema.sql` 파일도 업데이트하여 새 설치 시 nickname 컬럼 포함

### 2. RPC 함수 업데이트
- `create_signup_profile` 함수에 `p_nickname` 파라미터 추가
- `get_user_by_username` 함수에서 nickname 반환 추가
- 회원가입 시 닉네임도 함께 저장되도록 수정

### 3. Frontend 코드 수정
- `authService.js`에서 회원가입 시 닉네임 전달
- 프로필 로드 시 닉네임 정보 포함
- UI에서 닉네임을 우선적으로 표시 (닉네임 > 사용자명 > 이름)

## 마이그레이션 실행 순서

Supabase SQL Editor에서 다음 SQL 파일들을 순서대로 실행하세요:

### 1단계: 닉네임 컬럼 추가
```sql
-- sql/add_nickname_column.sql 파일의 내용을 실행
```

### 2단계: RPC 함수 업데이트
```sql
-- sql/update_signup_profile_with_nickname.sql 파일의 내용을 실행
```

## 실행 후 확인사항

1. **기존 사용자 처리**
   - 기존 사용자들의 nickname은 username으로 자동 설정됩니다
   - 필요시 관리자 페이지에서 개별 수정 가능

2. **신규 회원가입**
   - 회원가입 시 입력한 닉네임이 정상적으로 저장되고 표시되는지 확인

3. **UI 표시**
   - 로그인 후 헤더에 닉네임이 표시되는지 확인
   - 마이페이지에서도 닉네임이 표시되는지 확인

## 주의사항

- 마이그레이션 실행 전 데이터베이스 백업을 권장합니다
- 실행 중 에러가 발생하면 각 단계별로 확인하여 문제를 해결하세요
- 닉네임은 unique 제약조건이 있으므로 중복된 값은 허용되지 않습니다